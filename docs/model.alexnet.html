---

title: AlexNet -style CNN for voxel data


keywords: fastai
sidebar: home_sidebar

summary: "Process 40x40x105 voxels with traditional CNN"
description: "Process 40x40x105 voxels with traditional CNN"
nb_path: "nbs/07_model.alexnet.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/07_model.alexnet.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/mayrajeo/miniconda3/envs/enveco/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729062494/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() &gt; 0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="alexnetvoxel_learner" class="doc_header"><code>alexnetvoxel_learner</code><a href="https://github.com/jaeeolma/enveco/tree/master/enveco/model/alexnet.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>alexnetvoxel_learner</code>(<strong><code>dls</code></strong>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong><code>config</code></strong>=<em><code>None</code></em>, <strong><code>n_out</code></strong>=<em><code>None</code></em>, <strong><code>n_in</code></strong>=<em><code>3</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-blocks-and-utils">Building blocks and utils<a class="anchor-link" href="#Building-blocks-and-utils"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_same_padding_2d" class="doc_header"><code>calc_same_padding_2d</code><a href="https://github.com/jaeeolma/enveco/tree/master/enveco/model/alexnet.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_same_padding_2d</code>(<strong><code>inshape</code></strong>:<code>tuple</code>, <strong><code>kernel</code></strong>:<code>tuple</code>, <strong><code>strides</code></strong>:<code>tuple</code>)</p>
</blockquote>
<p>Calculate layer sizes similarly to tensorflow padding='same' for 2d data.
[left, right, top, bot] is the order for F.pad.
Has some kind of performance penalty.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PaddedConv2d" class="doc_header"><code>class</code> <code>PaddedConv2d</code><a href="https://github.com/jaeeolma/enveco/tree/master/enveco/model/alexnet.py#L65" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PaddedConv2d</code>(<strong><code>in_channels</code></strong>:<code>int</code>, <strong><code>out_channels</code></strong>:<code>int</code>, <strong><code>bias</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>same_padding</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong>**<code>kwargs</code></strong>:<code>Any</code>) :: <code>Module</code></p>
</blockquote>
<p>Module for Conv3d-BN-relu, with the option for tensorflow-style <code>same</code> padding</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PaddedMaxPool2d" class="doc_header"><code>class</code> <code>PaddedMaxPool2d</code><a href="https://github.com/jaeeolma/enveco/tree/master/enveco/model/alexnet.py#L92" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PaddedMaxPool2d</code>(<strong><code>same_padding</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong>**<code>kwargs</code></strong>:<code>Any</code>) :: <code>Module</code></p>
</blockquote>
<p>Module for MaxPool3d with optional tensorflow-style <code>same</code> padding</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AlexnetModel">AlexnetModel<a class="anchor-link" href="#AlexnetModel"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AlexNetVoxel" class="doc_header"><code>class</code> <code>AlexNetVoxel</code><a href="https://github.com/jaeeolma/enveco/tree/master/enveco/model/alexnet.py#L113" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AlexNetVoxel</code>(<strong><code>n_in</code></strong>:<code>int</code>, <strong><code>num_classes</code></strong>:<code>int</code>=<em><code>1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Custom AlexNet for voxel data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torchsummary</span> <span class="kn">import</span> <span class="n">summary</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AlexNetVoxel</span><span class="p">(</span><span class="n">n_in</span><span class="o">=</span><span class="mi">105</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="mi">105</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 1050, 40, 40]         441,000
       BatchNorm2d-2         [-1, 1050, 40, 40]           2,100
      PaddedConv2d-3         [-1, 1050, 40, 40]               0
         MaxPool2d-4         [-1, 1050, 20, 20]               0
   PaddedMaxPool2d-5         [-1, 1050, 20, 20]               0
            Conv2d-6          [-1, 256, 20, 20]       2,419,200
       BatchNorm2d-7          [-1, 256, 20, 20]             512
      PaddedConv2d-8          [-1, 256, 20, 20]               0
         MaxPool2d-9          [-1, 256, 10, 10]               0
  PaddedMaxPool2d-10          [-1, 256, 10, 10]               0
           Conv2d-11          [-1, 384, 10, 10]         884,736
      BatchNorm2d-12          [-1, 384, 10, 10]             768
     PaddedConv2d-13          [-1, 384, 10, 10]               0
           Conv2d-14          [-1, 384, 10, 10]       1,327,104
      BatchNorm2d-15          [-1, 384, 10, 10]             768
     PaddedConv2d-16          [-1, 384, 10, 10]               0
        MaxPool2d-17            [-1, 384, 5, 5]               0
  PaddedMaxPool2d-18            [-1, 384, 5, 5]               0
           Conv2d-19            [-1, 256, 5, 5]         884,736
      BatchNorm2d-20            [-1, 256, 5, 5]             512
     PaddedConv2d-21            [-1, 256, 5, 5]               0
        MaxPool2d-22            [-1, 256, 2, 2]               0
  PaddedMaxPool2d-23            [-1, 256, 2, 2]               0
          Flatten-24                 [-1, 1024]               0
      BatchNorm1d-25                 [-1, 1024]           2,048
           Linear-26                 [-1, 4096]       4,194,304
      BatchNorm1d-27                 [-1, 4096]           8,192
           Linear-28                 [-1, 4096]      16,777,216
      BatchNorm1d-29                 [-1, 4096]           8,192
           Linear-30                 [-1, 1000]       4,096,000
           Linear-31                    [-1, 1]           1,001
================================================================
Total params: 31,048,389
Trainable params: 31,048,389
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.64
Forward/backward pass size (MB): 49.81
Params size (MB): 118.44
Estimated Total Size (MB): 168.89
----------------------------------------------------------------
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

